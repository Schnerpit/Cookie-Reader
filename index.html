<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Cookie Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #cookieDisplay {
            width: 100%;
            height: 200px;
            margin-top: 20px;
            font-family: monospace;
        }
        .form-group {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Advanced Cookie Manager</h1>
    <p>Use the options below to add, view, or manage cookies.</p>

    <!-- Add a custom cookie -->
    <div>
        <div class="form-group">
            <label for="cookieName">Cookie Name:</label>
            <input type="text" id="cookieName" placeholder="Enter cookie name" required>
        </div>
        <div class="form-group">
            <label for="cookieValue">Cookie Value:</label>
            <input type="text" id="cookieValue" placeholder="Enter cookie value" required>
        </div>
        <div class="form-group">
            <label for="cookieExpiration">Expiration Date (optional, format: YYYY-MM-DDTHH:mm:ssZ):</label>
            <input type="text" id="cookieExpiration" placeholder="e.g., 2024-12-31T23:59:59Z">
        </div>
        <button onclick="addCustomCookie()">Add Cookie</button>
    </div>

    <!-- Buttons for actions -->
    <div>
        <button onclick="displayCookies()">Show Cookies</button>
        <button onclick="deleteAllCookies()">Delete All Cookies Added Here</button>
    </div>

    <!-- Textarea to display cookies -->
    <textarea id="cookieDisplay" readonly></textarea>

    <script>
        // Record the user's last visit
        function recordLastVisit() {
            const now = new Date().toISOString();
            document.cookie = `lastVisit=${encodeURIComponent(now)}; path=/; expires=${new Date(now).setFullYear(new Date().getFullYear() + 1)}`;
        }

        // Display cookies in a readable format
        function displayCookies() {
            const cookies = document.cookie;
            const outputArea = document.getElementById("cookieDisplay");

            if (!cookies) {
                outputArea.value = "No cookies found for this domain.";
                return;
            }

            // Parse and display cookies
            const formattedCookies = cookies.split('; ').map(cookie => {
                const [name, value] = cookie.split('=');
                return `Name: ${name}\nValue: ${decodeURIComponent(value || "")}`;
            }).join('\n\n');

            outputArea.value = formattedCookies;
        }

        // Add a custom cookie with optional expiration date
        function addCustomCookie() {
            const name = document.getElementById("cookieName").value.trim();
            const value = document.getElementById("cookieValue").value.trim();
            const expiration = document.getElementById("cookieExpiration").value.trim();

            if (!name || !value) {
                alert("Please provide both a cookie name and value.");
                return;
            }

            let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}; path=/;`;
            if (expiration) {
                const date = new Date(expiration);
                if (isNaN(date)) {
                    alert("Invalid expiration date format. Use ISO format: YYYY-MM-DDTHH:mm:ssZ");
                    return;
                }
                cookieString += ` expires=${date.toUTCString()};`;
            }

            document.cookie = cookieString;
            alert(`Cookie "${name}" has been added!`);
        }

        // Delete all cookies added here
        function deleteAllCookies() {
            const cookies = document.cookie.split('; ');
            cookies.forEach(cookie => {
                const [name] = cookie.split('=');
                document.cookie = `${name}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;`;
            });
            alert("All cookies have been deleted!");
            displayCookies();
        }

        // Set the last visit cookie on page unload
        window.addEventListener('unload', () => {
            recordLastVisit();
        });

        // Display cookies and set up the last visit on page load
        window.addEventListener('load', () => {
            const lastVisitCookie = document.cookie.split('; ').find(cookie => cookie.startsWith('lastVisit='));
            if (lastVisitCookie) {
                const lastVisit = decodeURIComponent(lastVisitCookie.split('=')[1]);
                alert(`Welcome back! Your last visit was on ${new Date(lastVisit).toLocaleString()}`);
            } else {
                alert("Welcome! This is your first visit.");
            }
            displayCookies();
        });
    </script>
</body>
</html>
